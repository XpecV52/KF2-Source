/*******************************************************************************
 * ConeBuilder generated by Eliot.UELib using UE Explorer.
 * Eliot.UELib ? 2009-2022 Eliot van Uytfanghe. All rights reserved.
 * http://eliotvu.com
 *
 * All rights belong to their respective owners.
 *******************************************************************************/
class ConeBuilder extends BrushBuilder
    hidecategories(Object,BrushBuilder);

var() float Z<ClampMin=0.000001>;
var() float CapZ;
var() float OuterRadius<ClampMin=0.000001>;
var() float InnerRadius;
var() int Sides<ClampMin=3>;
var() name GroupName;
var() bool AlignToSide;
var() bool Hollow;

function BuildCone(int Direction, bool InAlignToSide, int InSides, float InZ, float Radius, name Item)
{
    local int N, I, Ofs;

    N = GetVertexCount();
    if(InAlignToSide)
    {
        Radius /= Cos(3.141593 / float(InSides));
        Ofs = 1;
    }
    I = 0;
    J0x56:

    if(I < InSides)
    {
        Vertex3f(Radius * Sin((((2 * float(I)) + float(Ofs)) * 3.141593) / float(InSides)), Radius * Cos((((2 * float(I)) + float(Ofs)) * 3.141593) / float(InSides)), 0);
        ++ I;
        goto J0x56;
    }
    Vertex3f(0, 0, InZ);
    I = 0;
    J0x132:

    if(I < InSides)
    {
        Poly3i(Direction, N + I, N + InSides, N + ((I + 1) % InSides), Item);
        ++ I;
        goto J0x132;
    }
}

event bool Build()
{
    local int I;

    if(Sides < 3)
    {
        return BadParameters();
    }
    if((Z <= float(0)) || OuterRadius <= float(0))
    {
        return BadParameters();
    }
    if(Hollow && (InnerRadius <= float(0)) || InnerRadius >= OuterRadius)
    {
        return BadParameters();
    }
    if(Hollow && CapZ > Z)
    {
        return BadParameters();
    }
    if(Hollow && (CapZ == Z) && InnerRadius == OuterRadius)
    {
        return BadParameters();
    }
    BeginBrush(false, GroupName);
    BuildCone(1, AlignToSide, Sides, Z, OuterRadius, 'Top');
    if(Hollow)
    {
        BuildCone(-1, AlignToSide, Sides, CapZ, InnerRadius, 'Cap');
        if(OuterRadius != InnerRadius)
        {
            I = 0;
            J0x1C7:

            if(I < Sides)
            {
                Poly4i(1, I, (I + 1) % Sides, (Sides + 1) + ((I + 1) % Sides), (Sides + 1) + I, 'Bottom');
                ++ I;
                goto J0x1C7;
            }
        }        
    }
    else
    {
        PolyBegin(1, 'Bottom');
        I = 0;
        J0x27F:

        if(I < Sides)
        {
            Polyi(I);
            ++ I;
            goto J0x27F;
        }
        PolyEnd();
    }
    return EndBrush();
}

defaultproperties
{
    Z=256
    CapZ=256
    OuterRadius=512
    InnerRadius=384
    Sides=8
    GroupName=Cone
    AlignToSide=true
    BitmapFilename="Btn_Cone"
    ToolTip="BrushBuilderName_Cone"
}