/*******************************************************************************
 * MultiWebAdminUser generated by Eliot.UELib using UE Explorer.
 * Eliot.UELib ? 2009-2022 Eliot van Uytfanghe. All rights reserved.
 * http://eliotvu.com
 *
 * All rights belong to their respective owners.
 *******************************************************************************/
class MultiWebAdminUser extends BasicWebAdminUser
    hidecategories(Navigation,Movement,Collision)
    implements(ISettingsPrivileges);

var MultiAdminData adminData;
var string settingsPrivBaseUri;

function string getUserid()
{
    return string(adminData.Name);
}

function Logout()
{
    adminData = none;
    super.Logout();
}

function bool canPerform(string URI)
{
    local int Idx;

    addCheckedPrivileges(URI);
    if(adminData != none)
    {
        if(Left(URI, 11) ~= "webadmin://")
        {
            Idx = InStr(URI, "/",,, 11);
            if(Idx != -1)
            {
                URI = Mid(URI, Idx);
                if(URI == "/")
                {
                    return true;
                }
                return adminData.canAccess(URI);
            }
        }
    }
    return false;
}

function ISettingsPrivileges getSettingsPrivileges()
{
    return (self);
}

function setBasePrivilegeUri(string URI)
{
    settingsPrivBaseUri = URI;
}

function bool hasSettingsGroupAccess(class<WebAdminSettings> Settings, string GroupID)
{
    return canPerform((settingsPrivBaseUri $ "#") $ GroupID);
}

defaultproperties
{
    begin object name=Sprite class=SpriteComponent
        ReplacementPrimitive=none
    object end
    // Reference: SpriteComponent'Default__MultiWebAdminUser.Sprite'
    Components(0)=Sprite
}