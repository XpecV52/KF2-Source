/*******************************************************************************
 * MobileMenuBar generated by Eliot.UELib using UE Explorer.
 * Eliot.UELib ? 2009-2022 Eliot van Uytfanghe. All rights reserved.
 * http://eliotvu.com
 *
 * All rights belong to their respective owners.
 *******************************************************************************/
class MobileMenuBar extends MobileMenuObject;

/** Vertical or horizontal list supported */
var(DefaultInit) bool bIsVertical;
var bool bDirty;
/** Current selected index */
var(DefaultInit) int SelectedIndex;
var int FirstItem;
var array<MobileMenuBarItem> Items;

function InitMenuObject(MobilePlayerInput PlayerInput, MobileMenuScene Scene, int ScreenWidth, int ScreenHeight, bool bIsFirstInitialization)
{
    super.InitMenuObject(PlayerInput, Scene, ScreenWidth, ScreenHeight, bIsFirstInitialization);
    UpdateItemViewports();
}

function AddItem(MobileMenuBarItem Item, optional int Index)
{
    Index = -1;
    if(Index < 0)
    {
        Index = Items.Length + (Index + 1);
    }
    Items.InsertItem(Index, Item;
    bDirty = true;
}

function int Num()
{
    return Items.Length;
}

function MobileMenuBarItem GetSelected()
{
    if((SelectedIndex >= 0) && SelectedIndex < Items.Length)
    {
        return Items[SelectedIndex];
    }
    return none;
}

event bool OnTouch(Engine.Interaction.ETouchType EventType, float TouchX, float TouchY, MobileMenuObject ObjectOver, float DeltaTime)
{
    if(bIsVertical)
    {
        TouchY -= Top;
        SelectedIndex = FirstItem;
        J0x34:

        if(SelectedIndex < (Items.Length - 1))
        {
            TouchY -= float(Items[SelectedIndex].Height);
            if(TouchY <= float(0))
            {
                goto J0xA6;
            }
            ++ SelectedIndex;
            goto J0x34;
        }
        J0xA6:
        
    }
    else
    {
        TouchX -= Left;
        SelectedIndex = 0;
        J0xC8:

        if(SelectedIndex < (Items.Length - 1))
        {
            TouchX -= float(Items[SelectedIndex].Width);
            if(TouchX <= float(0))
            {
                goto J0x13A;
            }
            ++ SelectedIndex;
            goto J0xC8;
        }
    }
    J0x13A:

    return true;
}

function RenderObject(Canvas Canvas, float DeltaTime)
{
    local float OrgX, OrgY;
    local int CurIndex;

    if(bDirty)
    {
        UpdateItemViewports();
    }
    OrgX = Canvas.OrgX;
    OrgY = Canvas.OrgY;
    Canvas.SetOrigin(Left, Top);
    CurIndex = 0;
    J0xA3:

    if(CurIndex < Items.Length)
    {
        RenderItem(Canvas, DeltaTime, CurIndex);
        ++ CurIndex;
        goto J0xA3;
    }
    Canvas.OrgX = OrgX;
    Canvas.OrgY = OrgY;
}

function RenderItem(Canvas Canvas, float DeltaTime, int ItemIndex)
{
    Items[ItemIndex].RenderItem(self, Canvas, DeltaTime);
}

function SetFirstItem(int first)
{
    FirstItem = first;
    bDirty = true;
}

function UpdateItemViewports()
{
    local MobileMenuBarItem Item;
    local float pos;
    local int CurIndex;

    pos = 0;
    Width = 0;
    Height = 0;
    if(bIsVertical)
    {
        CurIndex = FirstItem;
        J0x4D:

        if(CurIndex < Items.Length)
        {
            Item = Items[CurIndex];
            Width = FMax(Width, float(Item.Width));
            Height += float(Item.Height);
            ++ CurIndex;
            goto J0x4D;
        }
        CurIndex = FirstItem;
        J0x103:

        if(CurIndex < Items.Length)
        {
            Item = Items[CurIndex];
            Item.VpPos.X = 0;
            Item.VpPos.Y = pos;
            pos += float(Item.Height);
            ++ CurIndex;
            goto J0x103;
        }        
    }
    else
    {
        CurIndex = FirstItem;
        J0x1F9:

        if(CurIndex < Items.Length)
        {
            Item = Items[CurIndex];
            Width += float(Item.Width);
            Height = FMax(Height, float(Item.Height));
            ++ CurIndex;
            goto J0x1F9;
        }
        CurIndex = FirstItem;
        J0x2AF:

        if(CurIndex < Items.Length)
        {
            Item = Items[CurIndex];
            Item.VpPos.X = pos;
            Item.VpPos.Y = 0;
            pos += float(Item.Width);
            ++ CurIndex;
            goto J0x2AF;
        }
    }
    bDirty = false;
}

defaultproperties
{
    bIsVertical=true
    bIsActive=true
}