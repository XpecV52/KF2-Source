/*******************************************************************************
 * KFPawn_ZedDAR_EMP generated by Eliot.UELib using UE Explorer.
 * Eliot.UELib ? 2009-2022 Eliot van Uytfanghe. All rights reserved.
 * http://eliotvu.com
 *
 * All rights belong to their respective owners.
 *******************************************************************************/
class KFPawn_ZedDAR_EMP extends KFPawn_ZedDAR
    config(Game)
    hidecategories(Navigation);

simulated function ANIMNOTIFY_EMPStart()
{
    ToggleEMPBurst(true);
}

simulated function ANIMNOTIFY_EMPEnd()
{
    ToggleEMPBurst(false);
    if(MyDARController != none)
    {
        MyDARController.LastRangeAttackTime = WorldInfo.TimeSeconds;
    }
}

simulated function ToggleEMPBurst(bool bEnable)
{
    local KFSM_DAR_EMPAttack EMPSM;

    if(SpecialMove != 22)
    {
        return;
    }
    EMPSM = KFSM_DAR_EMPAttack(SpecialMoves[SpecialMove]);
    if(EMPSM != none)
    {
        EMPSM.ToggleEMP(bEnable);
    }
}

simulated event Vector GetWeaponStartTraceLocation(optional Weapon CurrentWeapon)
{
    local KFAIController_ZedDAR_EMP DARAI;
    local Vector SocketLoc;
    local Rotator SocketRot;

    if(MyKFAIC != none)
    {
        DARAI = KFAIController_ZedDAR_EMP(MyKFAIC);
        if(DARAI != none)
        {
            Mesh.GetSocketWorldLocationAndRotation(DARAI.EMPSocketName, SocketLoc, SocketRot);
            return SocketLoc;
        }
    }
    return super(Pawn).GetWeaponStartTraceLocation(CurrentWeapon);
}

function OnZedDied(Controller Killer)
{
    local KFSM_DAR_EMPAttack EMPSM;

    super(KFPawn_Monster).OnZedDied(Killer);
    EMPSM = KFSM_DAR_EMPAttack(SpecialMoves[SpecialMove]);
    if(EMPSM != none)
    {
        EMPSM.ToggleEMP(false);
        EMPSM.ReleaseVictims();
    }
}

defaultproperties
{
    ExplosionTemplate=KFGameExplosion'Default__KFPawn_ZedDAR_EMP.ExploTemplate0'
    MonsterArchPath="ZED_ARCH.ZED_DAR_EMP_Archetype"
    MeleeAttackHelper=KFMeleeHelperAI'Default__KFPawn_ZedDAR_EMP.MeleeHelper'
    DifficultySettings=Class'KFDifficulty_DAR_EMP'
    SprintAkComponent=AkComponent'Default__KFPawn_ZedDAR_EMP.SprintAkComponent0'
    LocalizationKey=KFPawn_ZedDAR_EMP
    begin object name=ThirdPersonHead0 class=SkeletalMeshComponent
        ReplacementPrimitive=none
    object end
    // Reference: SkeletalMeshComponent'Default__KFPawn_ZedDAR_EMP.ThirdPersonHead0'
    ThirdPersonHeadMeshComponent=ThirdPersonHead0
    begin object name=Afflictions class=KFAfflictionManager
        AfflictionClasses=/* Array type was not detected. */
    object end
    // Reference: KFAfflictionManager'Default__KFPawn_ZedDAR_EMP.Afflictions'
    AfflictionHandler=Afflictions
    begin object name=FirstPersonArms class=KFSkeletalMeshComponent
        ReplacementPrimitive=none
    object end
    // Reference: KFSkeletalMeshComponent'Default__KFPawn_ZedDAR_EMP.FirstPersonArms'
    ArmsMesh=FirstPersonArms
    begin object name=SpecialMoveHandler class=KFSpecialMoveHandler
        SpecialMoveClasses=/* Array type was not detected. */
    object end
    // Reference: KFSpecialMoveHandler'Default__KFPawn_ZedDAR_EMP.SpecialMoveHandler'
    SpecialMoveHandler=SpecialMoveHandler
    AmbientAkComponent=AkComponent'Default__KFPawn_ZedDAR_EMP.AmbientAkSoundComponent_1'
    WeaponAkComponent=AkComponent'Default__KFPawn_ZedDAR_EMP.AmbientAkSoundComponent'
    WeaponAmbientEchoHandler=KFWeaponAmbientEchoHandler'Default__KFPawn_ZedDAR_EMP.WeaponAmbientEchoHandler'
    FootstepAkComponent=AkComponent'Default__KFPawn_ZedDAR_EMP.FootstepAkSoundComponent'
    DialogAkComponent=AkComponent'Default__KFPawn_ZedDAR_EMP.DialogAkSoundComponent'
    ControllerClass=Class'KFAIController_ZedDAR_EMP'
    begin object name=KFPawnSkeletalMeshComponent class=KFSkeletalMeshComponent
        ReplacementPrimitive=none
    object end
    // Reference: KFSkeletalMeshComponent'Default__KFPawn_ZedDAR_EMP.KFPawnSkeletalMeshComponent'
    Mesh=KFPawnSkeletalMeshComponent
    begin object name=CollisionCylinder class=CylinderComponent
        ReplacementPrimitive=none
    object end
    // Reference: CylinderComponent'Default__KFPawn_ZedDAR_EMP.CollisionCylinder'
    CylinderComponent=CollisionCylinder
    begin object name=Sprite class=SpriteComponent
        ReplacementPrimitive=none
    object end
    // Reference: SpriteComponent'Default__KFPawn_ZedDAR_EMP.Sprite'
    Components(0)=Sprite
    begin object name=CollisionCylinder class=CylinderComponent
        ReplacementPrimitive=none
    object end
    // Reference: CylinderComponent'Default__KFPawn_ZedDAR_EMP.CollisionCylinder'
    Components(1)=CollisionCylinder
    begin object name=Arrow class=ArrowComponent
        ReplacementPrimitive=none
    object end
    // Reference: ArrowComponent'Default__KFPawn_ZedDAR_EMP.Arrow'
    Components(2)=Arrow
    begin object name=KFPawnSkeletalMeshComponent class=KFSkeletalMeshComponent
        ReplacementPrimitive=none
    object end
    // Reference: KFSkeletalMeshComponent'Default__KFPawn_ZedDAR_EMP.KFPawnSkeletalMeshComponent'
    Components(3)=KFPawnSkeletalMeshComponent
    Components(4)=AkComponent'Default__KFPawn_ZedDAR_EMP.AmbientAkSoundComponent'
    Components(5)=AkComponent'Default__KFPawn_ZedDAR_EMP.AmbientAkSoundComponent_1'
    Components(6)=AkComponent'Default__KFPawn_ZedDAR_EMP.FootstepAkSoundComponent'
    Components(7)=AkComponent'Default__KFPawn_ZedDAR_EMP.DialogAkSoundComponent'
    Components(8)=AkComponent'Default__KFPawn_ZedDAR_EMP.SprintAkComponent0'
    begin object name=CollisionCylinder class=CylinderComponent
        ReplacementPrimitive=none
    object end
    // Reference: CylinderComponent'Default__KFPawn_ZedDAR_EMP.CollisionCylinder'
    CollisionComponent=CollisionCylinder
}