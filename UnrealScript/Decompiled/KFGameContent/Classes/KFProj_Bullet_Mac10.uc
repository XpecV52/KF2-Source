/*******************************************************************************
 * KFProj_Bullet_Mac10 generated by Eliot.UELib using UE Explorer.
 * Eliot.UELib ? 2009-2022 Eliot van Uytfanghe. All rights reserved.
 * http://eliotvu.com
 *
 * All rights belong to their respective owners.
 *******************************************************************************/
class KFProj_Bullet_Mac10 extends KFProj_Bullet_AssaultRifle
    hidecategories(Navigation);

var Vector LastHitNormal;
var float GroundFireChance;

simulated function ProcessTouch(Actor Other, Vector HitLocation, Vector HitNormal)
{
    LastHitNormal = HitNormal;
    super(KFProj_Bullet).ProcessTouch(Other, HitLocation, HitNormal);
}

simulated function TriggerExplosion(Vector HitLocation, Vector HitNormal, Actor HitActor)
{
    LastHitNormal = HitNormal;
    super(KFProj_Bullet).TriggerExplosion(HitLocation, HitNormal, HitActor);
}

protected simulated function StopSimulating()
{
    local Vector FlameSpawnVel;

    if((Role == ROLE_Authority) && FRand() < GroundFireChance)
    {
        FlameSpawnVel = 0.25 * (CalculateResidualFlameVelocity(LastHitNormal, Normal(Velocity), VSize(Velocity)));
        SpawnResidualFlame(Class'KFProj_Mac10Splash', Location + (LastHitNormal * 10), FlameSpawnVel);
    }
    super(KFProjectile).StopSimulating();
}

defaultproperties
{
    GroundFireChance=0.1
    ProjFlightTemplate=ParticleSystem'FX_Projectile_EMIT.FX_Tracer_9MM_ZEDTime'
    AmbientSoundPlayEvent=AkEvent'WW_WEP_SA_DragonsBreath.Play_SA_DragonsBreath_Projectile_Loop'
    AmbientSoundStopEvent=AkEvent'WW_WEP_SA_DragonsBreath.Stop_SA_DragonsBreath_Projectile_Loop'
    AmbientComponent=AkComponent'Default__KFProj_Bullet_Mac10.AmbientAkSoundComponent'
    ImpactEffects=KFImpactEffectInfo'WEP_MAC10_ARCH.Mac10_bullet_impact'
    begin object name=CollisionCylinder class=CylinderComponent
        ReplacementPrimitive=none
    object end
    // Reference: CylinderComponent'Default__KFProj_Bullet_Mac10.CollisionCylinder'
    CylinderComponent=CollisionCylinder
    begin object name=CollisionCylinder class=CylinderComponent
        ReplacementPrimitive=none
    object end
    // Reference: CylinderComponent'Default__KFProj_Bullet_Mac10.CollisionCylinder'
    Components(0)=CollisionCylinder
    Components(1)=AkComponent'Default__KFProj_Bullet_Mac10.AmbientAkSoundComponent'
    begin object name=CollisionCylinder class=CylinderComponent
        ReplacementPrimitive=none
    object end
    // Reference: CylinderComponent'Default__KFProj_Bullet_Mac10.CollisionCylinder'
    CollisionComponent=CollisionCylinder
}