/*******************************************************************************
 * KFGFxMoviePlayer_Tutorial generated by Eliot.UELib using UE Explorer.
 * Eliot.UELib ? 2009-2022 Eliot van Uytfanghe. All rights reserved.
 * http://eliotvu.com
 *
 * All rights belong to their respective owners.
 *******************************************************************************/
class KFGFxMoviePlayer_Tutorial extends GFxMoviePlayer
    config(UI);

var name SoundThemeName;
var KFGFxTutorialContainer TutorialContainer;
var array<STutorialSlide> TargetTutorialArray;
var KFGameInfo_Tutorial KFGI;
var KFTutorialSectionInfo TutorialSectionInfo;
var bool bUsingGamepad;
var GFxObject ManagerObject;

function Init(optional LocalPlayer LocPlay)
{
    super.Init(LocPlay);
    KFGI = KFGameInfo_Tutorial(GetPC().WorldInfo.Game);
}

event bool WidgetInitialized(name WidgetName, name WidgetPath, GFxObject Widget)
{
    local bool bHandled;

    bHandled = true;
    switch(WidgetName)
    {
        case 'root1':
            if(ManagerObject == none)
            {
                ManagerObject = Widget;
                if(Class'WorldInfo'.static.IsConsoleBuild(8))
                {
                    ManagerObject.SetBool("bUsingGamepad", true);
                }
            }
            break;
        case 'tutorialPopup':
            if(TutorialContainer == none)
            {
                TutorialContainer = KFGFxTutorialContainer(Widget);
                TutorialContainer.InitMenu();
                if(TargetTutorialArray.Length > 0)
                {
                    TutorialContainer.SetPopUpData(TargetTutorialArray);
                }
            }
            break;
        default:
            bHandled = false;
            break;
    }
    return bHandled;
}

event bool FilterButtonInput(int ControllerId, name ButtonName, Core.Object.EInputEvent InputEvent)
{
    if(!Class'WorldInfo'.static.IsConsoleBuild(8))
    {
        CheckIfUsingGamepad();
    }
    return false;
}

function CheckIfUsingGamepad()
{
    local bool bGamepad;

    bGamepad = GetUsingGamepad();
    if(bUsingGamepad != bGamepad)
    {
        OnInputTypeChanged(bGamepad);
    }
}

function OnInputTypeChanged(bool bGamepad)
{
    bUsingGamepad = bGamepad;
    if(ManagerObject != none)
    {
        ManagerObject.SetBool("bUsingGamepad", bGamepad);
    }
}

function bool GetUsingGamepad()
{
    local PlayerController PC;

    PC = GetPC();
    if((PC == none) || PC.PlayerInput == none)
    {
        return false;
    }
    return PC.PlayerInput.bUsingGamepad;
}

function Callback_Done()
{
    if(KFGI != none)
    {
        KFGI.RemoveTutorialHud();
    }
}

function Callback_Skip()
{
    if(KFGI != none)
    {
        KFGI.RemoveTutorialHud();
    }
}

defaultproperties
{
    SoundThemeName=ButtonSoundTheme
    MovieInfo=SwfMovie'UI_Tutorial.TutorialManager_SWF'
    bAutoPlay=true
    bCaptureInput=true
    bCaptureMouseInput=true
    CaptureKeys=/* Array type was not detected. */
    SoundThemes=/* Array type was not detected. */
    WidgetBindings=/* Array type was not detected. */
}