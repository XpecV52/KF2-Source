/*******************************************************************************
 * KFProj_Husk_Fireball generated by Eliot.UELib using UE Explorer.
 * Eliot.UELib ? 2009-2022 Eliot van Uytfanghe. All rights reserved.
 * http://eliotvu.com
 *
 * All rights belong to their respective owners.
 *******************************************************************************/
class KFProj_Husk_Fireball extends KFProjectile
    hidecategories(Navigation);

var protected const float BurnDuration;
var protected const float BurnDamageInterval;
var protected const class<KFExplosionActorLingering> GroundFireExplosionActorClass;
var bool bSpawnGroundFire;
var KFGameExplosion GroundFireExplosionTemplate;

replication
{
     if(bNetInitial)
        bSpawnGroundFire;
}

protected simulated function PrepareExplosionTemplate()
{
    super.PrepareExplosionTemplate();
    ExplosionTemplate.bIgnoreInstigator = true;
    GroundFireExplosionTemplate.bIgnoreInstigator = true;
}

simulated function TriggerExplosion(Vector HitLocation, Vector HitNormal, Actor HitActor)
{
    local KFExplosionActorLingering GFExplosionActor;

    if(bHasDisintegrated)
    {
        return;
    }
    if(!bHasExploded && bSpawnGroundFire)
    {
        GFExplosionActor = Spawn(GroundFireExplosionActorClass, self,, HitLocation + (HitNormal * 32), rotator(HitNormal));
        if(GFExplosionActor != none)
        {
            GFExplosionActor.Instigator = Instigator;
            GFExplosionActor.InstigatorController = InstigatorController;
            GroundFireExplosionTemplate.HitLocation = HitLocation;
            GroundFireExplosionTemplate.HitNormal = HitNormal;
            if(GroundFireExplosionTemplate.bDirectionalExplosion)
            {
                HitNormal = GetExplosionDirection(HitNormal);
            }
            GFExplosionActor.maxTime = BurnDuration;
            GFExplosionActor.interval = BurnDamageInterval;
            GFExplosionActor.Explode(GroundFireExplosionTemplate, HitNormal);
        }
    }
    super.TriggerExplosion(HitLocation, HitNormal, HitActor);
}

defaultproperties
{
    BurnDuration=4
    BurnDamageInterval=0.5
    GroundFireExplosionActorClass=Class'KFExplosion_HuskFireballGroundFire'
    begin object name=ExploTemplate1 class=KFGameExplosion
        ExplosionEffects=KFImpactEffectInfo'wep_molotov_arch.Molotov_GroundFire'
        bDirectionalExplosion=true
        Damage=3
        DamageRadius=150
        MyDamageType=Class'KFDT_Fire_ZedGround'
        KnockDownStrength=0
        MomentumTransferScale=0
        ExploLight=PointLightComponent'Default__KFProj_Husk_Fireball.FlamePointLight'
        ExploLightFadeOutTime=0.3
        ExploLightStartFadeOutTime=1.5
        FractureMeshRadius=0
        CamShake=none
    object end
    // Reference: KFGameExplosion'Default__KFProj_Husk_Fireball.ExploTemplate1'
    GroundFireExplosionTemplate=ExploTemplate1
    bAutoStartAmbientSound=true
    bStopAmbientSoundOnExplode=true
    ExplosionActorClass=Class'KFGame.KFExplosionActor'
    begin object name=ExploTemplate0 class=KFGameExplosion
        ExplosionEffects=KFImpactEffectInfo'FX_Impacts_ARCH.Explosions.HuskProjectile_Explosion'
        Damage=25
        DamageRadius=300
        MyDamageType=Class'KFDT_Fire_HuskFireball'
        MomentumTransferScale=60000
        ExplosionSound=AkEvent'WW_ZED_Husk.ZED_Husk_SFX_Ranged_Shot_Impact'
        ExploLight=PointLightComponent'Default__KFProj_Husk_Fireball.ExplosionPointLight'
        ExploLightFadeOutTime=0.5
        CamShake=KFCameraShake'FX_CameraShake_Arch.Misc_Explosions.HuskFireball'
    object end
    // Reference: KFGameExplosion'Default__KFProj_Husk_Fireball.ExploTemplate0'
    ExplosionTemplate=ExploTemplate0
    ProjFlightTemplate=ParticleSystem'ZED_Husk_EMIT.FX_Husk_projectile_01'
    AmbientSoundPlayEvent=AkEvent'WW_ZED_Husk.ZED_Husk_SFX_Ranged_Shot_LP'
    AmbientSoundStopEvent=AkEvent'WW_ZED_Husk.ZED_Husk_SFX_Ranged_Shot_LP_Stop'
    begin object name=AmbientAkSoundComponent class=AkComponent
        bStopWhenOwnerDestroyed=true
        bForceOcclusionUpdateInterval=true
        OcclusionUpdateInterval=0.1
    object end
    // Reference: AkComponent'Default__KFProj_Husk_Fireball.AmbientAkSoundComponent'
    AmbientComponent=AmbientAkSoundComponent
    Speed=1800
    MaxSpeed=1800
    bBlockedByInstigator=false
    begin object name=CollisionCylinder class=CylinderComponent
        ReplacementPrimitive=none
    object end
    // Reference: CylinderComponent'Default__KFProj_Husk_Fireball.CollisionCylinder'
    CylinderComponent=CollisionCylinder
    begin object name=CollisionCylinder class=CylinderComponent
        ReplacementPrimitive=none
    object end
    // Reference: CylinderComponent'Default__KFProj_Husk_Fireball.CollisionCylinder'
    Components(0)=CollisionCylinder
    begin object name=AmbientAkSoundComponent class=AkComponent
        bStopWhenOwnerDestroyed=true
        bForceOcclusionUpdateInterval=true
        OcclusionUpdateInterval=0.1
    object end
    // Reference: AkComponent'Default__KFProj_Husk_Fireball.AmbientAkSoundComponent'
    Components(1)=AmbientAkSoundComponent
    bCollideComplex=true
    begin object name=CollisionCylinder class=CylinderComponent
        ReplacementPrimitive=none
    object end
    // Reference: CylinderComponent'Default__KFProj_Husk_Fireball.CollisionCylinder'
    CollisionComponent=CollisionCylinder
}