/*******************************************************************************
 * KFWeap_GravityImploder generated by Eliot.UELib using UE Explorer.
 * Eliot.UELib ? 2009-2022 Eliot van Uytfanghe. All rights reserved.
 * http://eliotvu.com
 *
 * All rights belong to their respective owners.
 *******************************************************************************/
class KFWeap_GravityImploder extends KFWeapon
    config(Game)
    hidecategories(Navigation,Advanced,Collision,Mobile,Movement,Object,Physics,Attachment,Debug);

var float SelfDamageReductionValue;
var LinearColor DefaultFireMaterialColor;
var LinearColor AltFireMaterialColor;
var bool bLastFireWasAlt;
var const bool bDebugDrawVortex;

simulated function Activate()
{
    super.Activate();
    UpdateMaterial();
}

simulated function UpdateMaterial()
{
    local LinearColor MatColor;

    MatColor = ((bLastFireWasAlt) ? AltFireMaterialColor : DefaultFireMaterialColor);
    if(WeaponMICs.Length > 1)
    {
        WeaponMICs[1].SetVectorParameterValue('Vector_Center_Color_A', MatColor);
    }
}

simulated function Projectile ProjectileFire()
{
    UpdateMaterial();
    return super.ProjectileFire();
}

simulated function BeginFire(byte FireModeNum)
{
    super.BeginFire(FireModeNum);
    if((FireModeNum == 1) && !bLastFireWasAlt)
    {
        bLastFireWasAlt = true;        
    }
    else
    {
        if((FireModeNum == 0) && bLastFireWasAlt)
        {
            bLastFireWasAlt = false;
        }
    }
}

simulated function AltFireMode()
{
    StartFire(1);
}

function AdjustDamage(out int InDamage, class<DamageType> DamageType, Actor DamageCauser)
{
    super.AdjustDamage(InDamage, DamageType, DamageCauser);
    if(((Instigator != none) && DamageCauser != none) && DamageCauser.Instigator == Instigator)
    {
        InDamage *= SelfDamageReductionValue;
    }
}

defaultproperties
{
    SelfDamageReductionValue=0.075
    DefaultFireMaterialColor=(R=0.965,G=0.2972,B=0,A=1)
    AltFireMaterialColor=(R=0,G=0.9631,B=0.96581,A=1)
    PackageKey="Gravity_Imploder"
    FirstPersonMeshName="WEP_1P_Gravity_Imploder_MESH.Wep_1stP_Gravity_Imploder_Rig"
    FirstPersonAnimSetNames=/* Array type was not detected. */
    PickupMeshName="WEP_3P_Gravity_Imploder_MESH.WEP_3rdP_Gravity_Imploder_Pickup"
    AttachmentArchetypeName="WEP_Gravity_Imploder_ARCH.Wep_Gravity_Imploder_3P"
    MuzzleFlashTemplateName="WEP_Gravity_Imploder_ARCH.Wep_Gravity_Imploder_MuzzleFlash"
    bHasIronSights=true
    bWarnAIWhenAiming=true
    bCanBeReloaded=true
    bReloadFromMagazine=true
    bHasFireLastAnims=true
    FireModeIconPaths=/* Array type was not detected. */
    InventorySize=8
    MeshFOV=75
    MeshIronSightFOV=40
    PlayerIronSightFOV=65
    IronSightPosition=(X=10,Y=0,Z=-1.9)
    DOF_FG_MaxNearBlurSize=3.5
    AimWarningDelay=(X=0.4,Y=0.8)
    GroupPriority=125
    WeaponSelectTexture=Texture2D'WEP_UI_Gravity_Imploder_TEX.UI_WeaponSelect_Gravity_Imploder'
    MagazineCapacity=6
    SpareAmmoCapacity=42
    InitialSpareMags=2
    WeaponFireWaveForm=ForceFeedbackWaveform'FX_ForceFeedback_ARCH.Gunfire.Medium_Recoil'
    WeaponFireSnd=/* Array type was not detected. */
    WeaponDryFireSnd=/* Array type was not detected. */
    PlayerViewOffset=(X=5.5,Y=8,Z=-2)
    NumBloodMapMaterials=2
    MeleeAttackHelper=KFMeleeHelperWeapon'Default__KFWeap_GravityImploder.MeleeHelper'
    EjectedShellForegroundDuration=1.5
    maxRecoilPitch=750
    minRecoilPitch=675
    maxRecoilYaw=250
    minRecoilYaw=-250
    RecoilRate=0.08
    RecoilViewRotationScale=0.6
    RecoilMaxYawLimit=500
    RecoilMinYawLimit=65035
    RecoilMaxPitchLimit=1250
    RecoilMinPitchLimit=64785
    RecoilISMaxYawLimit=50
    RecoilISMinYawLimit=65485
    RecoilISMaxPitchLimit=500
    RecoilISMinPitchLimit=65485
    IronSightMeshFOVCompensationScale=1.5
    AssociatedPerkClasses=/* Array type was not detected. */
    FiringStatesArray=/* Array type was not detected. */
    WeaponFireTypes=/* Array type was not detected. */
    WeaponProjectiles=/* Array type was not detected. */
    FireInterval=/* Array type was not detected. */
    Spread=/* Array type was not detected. */
    InstantHitDamage=/* Array type was not detected. */
    InstantHitDamageTypes=/* Array type was not detected. */
    FireOffset=(X=25,Y=3,Z=-2.5)
    begin object name=FirstPersonMesh class=KFSkeletalMeshComponent
        ReplacementPrimitive=none
    object end
    // Reference: KFSkeletalMeshComponent'Default__KFWeap_GravityImploder.FirstPersonMesh'
    Mesh=FirstPersonMesh
    ItemName="Gravity Imploder"
    begin object name=StaticPickupComponent class=StaticMeshComponent
        ReplacementPrimitive=none
    object end
    // Reference: StaticMeshComponent'Default__KFWeap_GravityImploder.StaticPickupComponent'
    DroppedPickupMesh=StaticPickupComponent
    begin object name=StaticPickupComponent class=StaticMeshComponent
        ReplacementPrimitive=none
    object end
    // Reference: StaticMeshComponent'Default__KFWeap_GravityImploder.StaticPickupComponent'
    PickupFactoryMesh=StaticPickupComponent
}