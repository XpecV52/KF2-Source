/*******************************************************************************
 * KFWeapAttach_Dual_C4 generated by Eliot.UELib using UE Explorer.
 * Eliot.UELib ? 2009-2022 Eliot van Uytfanghe. All rights reserved.
 * http://eliotvu.com
 *
 * All rights belong to their respective owners.
 *******************************************************************************/
class KFWeapAttach_Dual_C4 extends KFWeapAttach_DualBase
    hidecategories(Navigation,Object,Movement,Attachment,Collision,Physics,Advanced,Debug,Mobile);

const ThrowAnim = 'C4_Throw';
const CrouchThrowAnim = 'C4_Throw_CH';
const DetonateAnim = 'Shoot';
const CrouchDetonateAnim = 'CH_Shoot';

simulated function bool ThirdPersonFireEffects(Vector HitLocation, KFPawn P, byte ThirdPersonAnimRateByte)
{
    local float Duration;

    if(!ActorEffectIsRelevant(P, false, MaxFireEffectDistance))
    {
        return false;
    }
    DecodeThirdPersonAnimRate(ThirdPersonAnimRateByte);
    if(P.FiringMode == 0)
    {
        Duration = WeapMesh.GetAnimLength('C4_Throw');
        WeapMesh.PlayAnim('C4_Throw', Duration / ThirdPersonAnimRate,, true);
        SetTimer(0.75, false, 'UnHide');        
    }
    else
    {
        if(P.FiringMode == 5)
        {
            Duration = WeapMesh.GetAnimLength('Shoot');
            LeftWeapMesh.PlayAnim('Shoot', Duration / ThirdPersonAnimRate,, true);
        }
    }
    if(!P.IsDoingSpecialMove())
    {
        if(P.FiringMode == 0)
        {
            if(P.bIsCrouched)
            {
                P.PlayBodyAnim('C4_Throw_CH', 4, ThirdPersonAnimRate, ShootBlendInTime, ShootBlendOutTime);                
            }
            else
            {
                P.PlayBodyAnim('C4_Throw', 1, ThirdPersonAnimRate, ShootBlendInTime, ShootBlendOutTime);
            }            
        }
        else
        {
            if(P.FiringMode == 5)
            {
                if(P.bIsCrouched)
                {
                    P.PlayBodyAnim('CH_Shoot', 4, ThirdPersonAnimRate, ShootBlendInTime, ShootBlendOutTime);                    
                }
                else
                {
                    P.PlayBodyAnim('Shoot', 1, ThirdPersonAnimRate, ShootBlendInTime, ShootBlendOutTime);
                }
            }
        }
    }
    P.LastWeaponFireTime = -1;
    return true;
}

simulated function UnHide()
{
    if(WeapMesh != none)
    {
        WeapMesh.UnHideBoneByName('RW_Weapon');
    }
}

defaultproperties
{
    begin object name=SkeletalMeshComponent1 class=SkeletalMeshComponent
        Animations=AnimNodeSequence'Default__KFWeapAttach_Dual_C4.SkeletalMeshComponent1.MeshSequenceA'
        ReplacementPrimitive=none
    object end
    // Reference: SkeletalMeshComponent'Default__KFWeapAttach_Dual_C4.SkeletalMeshComponent1'
    LeftWeapMesh=SkeletalMeshComponent1
    begin object name=SkeletalMeshComponent0 class=SkeletalMeshComponent
        Animations=AnimNodeSequence'Default__KFWeapAttach_Dual_C4.SkeletalMeshComponent0.MeshSequenceA'
        ReplacementPrimitive=none
    object end
    // Reference: SkeletalMeshComponent'Default__KFWeapAttach_Dual_C4.SkeletalMeshComponent0'
    WeapMesh=SkeletalMeshComponent0
}