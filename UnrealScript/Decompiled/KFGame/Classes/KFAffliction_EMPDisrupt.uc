/*******************************************************************************
 * KFAffliction_EMPDisrupt generated by Eliot.UELib using UE Explorer.
 * Eliot.UELib ? 2009-2022 Eliot van Uytfanghe. All rights reserved.
 * http://eliotvu.com
 *
 * All rights belong to their respective owners.
 *******************************************************************************/
class KFAffliction_EMPDisrupt extends KFAffliction_EMP;

const DISRUPT_THRESHOLD = 25.f;

function Accrue(float InPower)
{
    super(KFAfflictionBase).Accrue(InPower);
    if(CurrentStrength > 25)
    {
        SetEMPDisrupted(true);
        PawnOwner.SetTimer(Duration, false, 'EMPDisruptTimer', self);
    }
}

function EMPDisruptTimer()
{
    SetEMPDisrupted(false);
}

function SetEMPDisrupted(bool bEnabled)
{
    if(PawnOwner.Role == ROLE_Authority)
    {
        if(PawnOwner.bEmpDisrupted == bEnabled)
        {
            return;
        }
        PawnOwner.bEmpDisrupted = bEnabled;
        if(PawnOwner.IsDoingSpecialMove())
        {
            PawnOwner.SpecialMoves[SpecialMove].OnEMPDisrupted();
        }
        PawnOwner.OnStackingAfflictionChanged(0);
    }
    ToggleEffects(PawnOwner.bEmpDisrupted, PawnOwner.bEmpPanicked);
}
