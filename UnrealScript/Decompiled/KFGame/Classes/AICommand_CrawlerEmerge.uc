/*******************************************************************************
 * AICommand_CrawlerEmerge generated by Eliot.UELib using UE Explorer.
 * Eliot.UELib ? 2009-2022 Eliot van Uytfanghe. All rights reserved.
 * http://eliotvu.com
 *
 * All rights belong to their respective owners.
 *******************************************************************************/
class AICommand_CrawlerEmerge extends AICommand_PushedBySM within KFAIController_ZedCrawler;

static function bool Emerge(KFAIController_ZedCrawler AI)
{
    local AICommand_CrawlerEmerge Cmd;

    if(AI != none)
    {
        Cmd = new (AI) default.Class;
        if(Cmd != none)
        {
            AI.PushCommand(Cmd);
            return true;
        }
    }
    return false;
}

function NavigationPoint GetStartAnchor()
{
    return none;
}

function NavigationPoint GetUpdatedAnchor()
{
    return none;
}

function SpecialMoveTimeout()
{
    Outer.AILog_Internal(string(self) $ " Special move timed out", 'Command_PushedBySM');
    if(Outer.MyKFPawn.SpecialMove == SpecialMove)
    {
        Outer.MyKFPawn.EndSpecialMove();
    }
    if(Outer.MyKFPawn != none)
    {
        Outer.MyKFPawn.MyKFAIC.AttemptToTeleport();
        return;
    }
    Status = 'Failure';
    Outer.AbortCommand(self);
}

state WaitForMove
{
    function bool IsSpecialMoveComplete()
    {
        if((!Outer.bPreparingMove || Outer.MyKFPawn == none) || Outer.MyKFPawn.SpecialMove != SpecialMove)
        {
            return true;
        }
        return false;
    }
Begin:

    Outer.SetTimer(TimeOutDelaySeconds, false, 'SpecialMoveTimeout', self);
    J0x2C:

    Outer.Sleep(0.1);
    if(!(IsSpecialMoveComplete()))
        goto J0x2C;
    Outer.AILog_Internal(((((("bPreparingMove:" @ string(Outer.bPreparingMove)) @ "MyKFPawn:") @ string(Outer.MyKFPawn)) @ "SpecialMove:") @ string(Outer.MyKFPawn.SpecialMove)) @ string(SpecialMove), 'Command_PushedBySM');
    Status = 'Success';
    Outer.PopCommand(self);
    stop;                    
}

defaultproperties
{
    TimeOutDelaySeconds=11
}