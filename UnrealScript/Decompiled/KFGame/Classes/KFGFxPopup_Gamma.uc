/*******************************************************************************
 * KFGFxPopup_Gamma generated by Eliot.UELib using UE Explorer.
 * Eliot.UELib ? 2009-2022 Eliot van Uytfanghe. All rights reserved.
 * http://eliotvu.com
 *
 * All rights belong to their respective owners.
 *******************************************************************************/
class KFGFxPopup_Gamma extends KFGFxObject_Popup within GFxMoviePlayer;

var GFxObject GammaSlider;
var string GammaImagePath;

function InitializePopup(KFGFxMoviePlayer_Manager InManager)
{
    super.InitializePopup(InManager);
    GammaSlider = GetObject("mainSlider");
    GammaSlider.SetFloat("value", Class'KFGameEngine'.default.GammaMultiplier * float(100));
    SetString("imagePath", "img://" $ GammaImagePath);
    Manager.bEnableGammaCorrection = true;
    Manager.RefreshViewportFlags();
}

event OnClosed()
{
    super.OnClosed();
    Manager.bEnableGammaCorrection = false;
    Manager.RefreshViewportFlags();
    Manager.bSetGamma = true;
    Manager.SaveConfig();
}

function SetGamma(float GammaValue)
{
    local KFGameEngine KFGE;

    KFGE = KFGameEngine(Class'Engine'.static.GetEngine());
    KFGE.GammaMultiplier = GammaValue;
    KFGE.SaveConfig();
    Class'KFGameEngine'.static.SetGamma(GammaValue);
    Class'KFGameEngine'.default.GammaMultiplier = GammaValue;
    Class'KFGameEngine'.static.StaticSaveConfig();
}

function ResetGamma()
{
    local float DefaultGamma;
    local KFGameEngine KFGE;

    DefaultGamma = Class'KFGameEngine'.default.DefaultGammaMult;
    GammaSlider.SetFloat("value", DefaultGamma * float(100));
    KFGE = KFGameEngine(Class'Engine'.static.GetEngine());
    KFGE.GammaMultiplier = DefaultGamma;
    KFGE.SaveConfig();
    Class'KFGameEngine'.static.SetGamma(DefaultGamma);
    Class'KFGameEngine'.default.GammaMultiplier = DefaultGamma;
    Class'KFGameEngine'.static.StaticSaveConfig();
}

function Callback_ClosedPopup()
{
    super.Callback_ClosedPopup();
}

function Callback_GammaChanged(float NewGamma)
{
    SetGamma(NewGamma / float(100));
}

function Callback_DefaultGamma()
{
    ResetGamma();
}

defaultproperties
{
    GammaImagePath="UI_GammaPopup_TEX.KF2_Brightess_Calibration"
}