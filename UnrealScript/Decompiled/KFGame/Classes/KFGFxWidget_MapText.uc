/*******************************************************************************
 * KFGFxWidget_MapText generated by Eliot.UELib using UE Explorer.
 * Eliot.UELib ? 2009-2022 Eliot van Uytfanghe. All rights reserved.
 * http://eliotvu.com
 *
 * All rights belong to their respective owners.
 *******************************************************************************/
class KFGFxWidget_MapText extends GFxObject within GFxMoviePlayer;

struct MapStoredMessage
{
    var string Text;
    var float DisplayTime;

    structdefaultproperties
    {
        Text=""
        DisplayTime=0
    }
};

var GFxObject mapTextField;
var KFPlayerController KFPC;
var transient float CurrentDisplayTime;
var transient float ControlTime;
var array<MapStoredMessage> StoredMessageList;

function InitializeHUD()
{
    KFPC = KFPlayerController(Outer.GetPC());
    mapTextField = GetObject("mapText");
    SetVisible(false);
}

function DisplayMapText(string MapText, float DisplayTime, bool bWaitForTheNextMessageToFinish)
{
    local MapStoredMessage StoredMessage;

    if(mapTextField != none)
    {
        if((ControlTime > float(0)) && bWaitForTheNextMessageToFinish)
        {
            StoredMessage.Text = MapText;
            StoredMessage.DisplayTime = DisplayTime;
            StoredMessageList.AddItem(StoredMessage;
            return;
        }
        ControlTime = DisplayTime;
        CurrentDisplayTime = DisplayTime;
        mapTextField.SetText(MapText);
        SetVisible(true);
    }
}

function TickHud(float DeltaTime)
{
    if(ControlTime > float(0))
    {
        ControlTime -= DeltaTime;
        if(ControlTime <= float(0))
        {
            HideMessage();
        }
    }
}

function HideMessage()
{
    if(StoredMessageList.Length > 0)
    {
        ControlTime += StoredMessageList[0].DisplayTime;
        CurrentDisplayTime = StoredMessageList[0].DisplayTime;
        mapTextField.SetText(StoredMessageList[0].Text);
        SetVisible(true);
        StoredMessageList.Remove(0, 1;
        return;
    }
    mapTextField.SetText("");
    SetVisible(false);
}
