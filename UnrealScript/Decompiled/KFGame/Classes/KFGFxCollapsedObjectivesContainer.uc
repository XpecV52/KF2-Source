/*******************************************************************************
 * KFGFxCollapsedObjectivesContainer generated by Eliot.UELib using UE Explorer.
 * Eliot.UELib ? 2009-2022 Eliot van Uytfanghe. All rights reserved.
 * http://eliotvu.com
 *
 * All rights belong to their respective owners.
 *******************************************************************************/
class KFGFxCollapsedObjectivesContainer extends KFGFxObject_Container within GFxMoviePlayer;

function Initialize(KFGFxObject_Menu NewParentMenu)
{
    super.Initialize(NewParentMenu);
    PopulateData();
}

function PopulateData()
{
    local int ItemIndex, I;
    local GFxObject DataObject, DataProvider;
    local class<KFGFxSpecialEventObjectivesContainer> SpecialEventClass;
    local KFPlayerController KFPC;
    local int CurrentProgressValue, MaxProgressValue;
    local float ProgressCompletePercentage;

    KFPC = KFPlayerController(Outer.GetPC());
    DataProvider = Outer.CreateArray();
    ItemIndex = 0;
    if(DataProvider == none)
    {
        return;
    }
    I = 0;
    J0x82:

    if(I < 3)
    {
        DataObject = Outer.CreateObject("Object");
        if(DataObject != none)
        {
            Class'KFGFxDailyObjectivesContainer'.static.MakeDailyDataObject(KFPC.GetDailyObjective(I), I, KFPC, DataObject);
            if(DataObject == none)
            {
                goto J0x184;
            }
            DataProvider.SetElementObject(ItemIndex, DataObject);
        }
        ++ ItemIndex;
        J0x184:

        ++ I;
        goto J0x82;
    }
    if(KFPC.IsA('KFPlayerController_WeeklySurvival') || Class'WorldInfo'.static.IsMenuLevel())
    {
        DataProvider.SetElementObject(ItemIndex, GetWeeklyDataObject());
        ++ ItemIndex;
    }
    SpecialEventClass = Class'KFGFxMenu_StartGame'.static.GetSpecialEventClass(Class'KFGameEngine'.static.GetSeasonalEventID());
    if((SpecialEventClass != none) && SpecialEventClass != Class'KFGFxSpecialEventObjectivesContainer')
    {
        I = 0;
        J0x292:

        if(I < SpecialEventClass.default.SpecialEventObjectiveInfoList.Length)
        {
            DataObject = Outer.CreateObject("Object");
            DataObject.SetString("label", SpecialEventClass.default.SpecialEventObjectiveInfoList[I].TitleString);
            DataObject.SetString("description", SpecialEventClass.default.SpecialEventObjectiveInfoList[I].DescriptionString);
            DataObject.SetString("iconPath", "img://" $ SpecialEventClass.default.ObjectiveIconURLs[I]);
            DataObject.SetBool("complete", KFPC.IsEventObjectiveComplete(I));
            DataObject.SetBool("showProgress", SpecialEventClass.default.UsesProgressList[I]);
            if(SpecialEventClass.default.UsesProgressList[I])
            {
                SpecialEventClass.static.GetObjectiveProgressValues(I, CurrentProgressValue, MaxProgressValue, ProgressCompletePercentage);
                DataObject.SetFloat("progress", ProgressCompletePercentage);
                DataObject.SetString("textValue", (string(CurrentProgressValue) $ "/") $ string(MaxProgressValue));
            }
            DataProvider.SetElementObject(ItemIndex, DataObject);
            ++ ItemIndex;
            ++ I;
            goto J0x292;
        }
    }
    SetObject("objectives", DataProvider);
}

function GFxObject GetWeeklyDataObject()
{
    local GFxObject DataObject;
    local KFWeeklyOutbreakInformation WeeklyInfo;
    local KFPlayerController KFPC;

    KFPC = KFPlayerController(Outer.GetPC());
    WeeklyInfo = Class'KFMission_LocalizedStrings'.static.GetCurrentWeeklyOutbreakInfo();
    DataObject = Outer.CreateObject("Object");
    if(WeeklyInfo == none)
    {
        return DataObject;
    }
    DataObject.SetString("label", WeeklyInfo.FriendlyName);
    if(WeeklyInfo.DescriptionStrings.Length > 0)
    {
        DataObject.SetString("description", (WeeklyInfo.DescriptionStrings[0] @ "
") @ WeeklyInfo.DescriptionStrings[1]);
    }
    DataObject.SetString("iconPath", "img://" $ WeeklyInfo.IconPath);
    DataObject.SetBool("complete", KFPC.IsWeeklyEventComplete());
    DataObject.SetBool("showProgres", false);
    DataObject.SetFloat("progress", 0);
    DataObject.SetString("textValue", "");
    return DataObject;
}
