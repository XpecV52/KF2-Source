/*******************************************************************************
 * KFSeqAct_SetMonsterProperties generated by Eliot.UELib using UE Explorer.
 * Eliot.UELib ? 2009-2022 Eliot van Uytfanghe. All rights reserved.
 * http://eliotvu.com
 *
 * All rights belong to their respective owners.
 *******************************************************************************/
class KFSeqAct_SetMonsterProperties extends SequenceAction
    forcescriptorder(true)
    hidecategories(Object);

struct SMonsterProperty
{
    /** Type of Property to be modified */
    var() KFGameInfo.EMonsterProperties Type;
    /** Whether this should effects all zeds that are spawned after this is enabled */
    var() bool bFutureZeds;
    /** Whether this should immediately affect all alive zeds when enabled */
    var() bool bCurrentZeds;

    structdefaultproperties
    {
        Type=EMonsterProperties.EMonsterProperties_Enraged
        bFutureZeds=false
        bCurrentZeds=false
    }
};

/** List of properties that should be modified on all zeds when this node is enabled */
var() array<SMonsterProperty> MonsterProperties;

event Activated()
{
    local bool bEnable;
    local int I;
    local KFGameInfo KFGI;
    local KFPawn_Monster KFPM;
    local WorldInfo KFWorldInfo;

    if(InputLinks[0].bHasImpulse)
    {
        bEnable = true;        
    }
    else
    {
        if(InputLinks[1].bHasImpulse)
        {
            bEnable = false;            
        }
        else
        {
            return;
        }
    }
    KFWorldInfo = Class'WorldInfo'.static.GetWorldInfo();
    KFGI = KFGameInfo(KFWorldInfo.Game);
    I = 0;
    J0xC9:

    if(I < MonsterProperties.Length)
    {
        if(MonsterProperties[I].bFutureZeds && KFGI != none)
        {
            KFGI.SpawnedMonsterProperties[MonsterProperties[I].Type] = int(bEnable);
        }
        if(MonsterProperties[I].bCurrentZeds)
        {
            foreach KFWorldInfo.AllPawns(Class'KFPawn_Monster', KFPM)
            {
                switch(MonsterProperties[I].Type)
                {
                    case 0:
                        KFPM.SetEnraged(bEnable);
                        break;
                    case 1:
                        KFPM.bSprintOverride = bEnable;
                        break;
                    default:
                        break;
                }                
            }            
        }
        ++ I;
        goto J0xC9;
    }
}

defaultproperties
{
    bCallHandler=false
    InputLinks(0)=(LinkDesc="Enable",bHasImpulse=false,QueuedActivations=0,bDisabled=false,bDisabledPIE=false,LinkedOp=none,DrawY=0,bHidden=false,ActivateDelay=0,bMoving=false,bClampedMax=false,bClampedMin=false,OverrideDelta=0)
    InputLinks(1)=(LinkDesc="Disable",bHasImpulse=false,QueuedActivations=0,bDisabled=false,bDisabledPIE=false,LinkedOp=none,DrawY=0,bHidden=false,ActivateDelay=0,bMoving=false,bClampedMax=false,bClampedMin=false,OverrideDelta=0)
    ObjName="Set Monster Properties"
    ObjCategory="Killing Floor"
}