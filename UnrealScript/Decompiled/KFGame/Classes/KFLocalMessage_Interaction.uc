/*******************************************************************************
 * KFLocalMessage_Interaction generated by Eliot.UELib using UE Explorer.
 * Eliot.UELib ? 2009-2022 Eliot van Uytfanghe. All rights reserved.
 * http://eliotvu.com
 *
 * All rights belong to their respective owners.
 *******************************************************************************/
class KFLocalMessage_Interaction extends KFLocalMessage;

enum EInteractionMessageType
{
    IMT_None,
    IMT_UseTrader,
    IMT_UseDoor,
    IMT_AcceptObjective,
    IMT_ReceiveAmmo,
    IMT_HealSelfWarning,
    IMT_ClotGrabWarning,
    IMT_ReceiveGrenades,
    IMT_MAX
};

var const localized string UseTraderMessage;
var const localized string UseDoorMessage;
var const localized string AcceptObjectiveMessage;
var const localized string ReceiveAmmoMessage;
var const localized string ReceiveGrenadesMessage;
var const localized string HealSelfWarning;
var const localized string PressToBashWarning;
var const string USE_COMMAND;
var const string HEAL_COMMAND;
var const string HEAL_COMMAND_CONTROLLER;
var const string BASH_COMMAND_CONTROLLER;
var const string BASH_COMMAND;

static function ClientReceive(PlayerController P, optional int Switch, optional PlayerReplicationInfo RelatedPRI_1, optional PlayerReplicationInfo RelatedPRI_2, optional Object OptionalObject)
{
    local string MessageString;
    local KFGFxMoviePlayer_HUD GFxHud;

    if(KFGFxHudWrapper(P.myHUD) != none)
    {
        GFxHud = KFGFxHudWrapper(P.myHUD).HudMovie;
        if(GFxHud != none)
        {
            MessageString = GetString(Switch, RelatedPRI_1 == P.PlayerReplicationInfo, RelatedPRI_1, RelatedPRI_2, OptionalObject);
            GFxHud.DisplayInteractionMessage(MessageString, Switch, GetKeyBind(P, Switch));
        }
    }
}

static function string GetKeyBind(PlayerController P, optional int Switch)
{
    local KFPlayerInput KFInput;
    local KeyBind BoundKey;
    local string KeyString;

    KFInput = KFPlayerInput(P.PlayerInput);
    if(KFInput == none)
    {
        return "";
    }
    switch(Switch)
    {
        case 1:
        case 2:
        case 3:
        case 4:
        case 7:
            KFInput.GetKeyBindFromCommand(BoundKey, default.USE_COMMAND, false);
            KeyString = KFInput.GetBindDisplayName(BoundKey);
            break;
        case 5:
            KFInput.GetKeyBindFromCommand(BoundKey, default.HEAL_COMMAND, false);
            if(BoundKey.Name == 'None')
            {
                KFInput.GetKeyBindFromCommand(BoundKey, default.HEAL_COMMAND_CONTROLLER, false);
            }
            KeyString = KFInput.GetBindDisplayName(BoundKey);
            break;
        case 6:
            KFInput.GetKeyBindFromCommand(BoundKey, default.BASH_COMMAND, false);
            KeyString = KFInput.GetBindDisplayName(BoundKey);
            break;
        default:
            break;
    }
    return KeyString;
}

static function string GetString(optional int Switch, optional bool bPRI1HUD, optional PlayerReplicationInfo RelatedPRI_1, optional PlayerReplicationInfo RelatedPRI_2, optional Object OptionalObject)
{
    switch(Switch)
    {
        case 1:
            return default.UseTraderMessage;
        case 2:
            return default.UseDoorMessage;
        case 3:
            return default.AcceptObjectiveMessage;
        case 4:
            return default.ReceiveAmmoMessage;
        case 7:
            return default.ReceiveGrenadesMessage;
        case 5:
            return default.HealSelfWarning;
        case 6:
            return default.PressToBashWarning;
        default:
            return "";
            break;
    }
}

static function float GetPos(int Switch, HUD myHUD)
{
    return 0.8;
}

static function string GetHexColor(int Switch)
{
    return default.InteractionColor;
}

defaultproperties
{
    UseTraderMessage="Press <%x%> to trade"
    UseDoorMessage="PRESS <%x%> to use, HOLD to equip welder"
    AcceptObjectiveMessage="Press <%x%> to accept objective"
    ReceiveAmmoMessage="Press <%x%> to receive ammo from supplier"
    ReceiveGrenadesMessage="Press <%x%> to receive grenades from supplier"
    HealSelfWarning="Press <%x%> to heal yourself."
    PressToBashWarning="Press <%x%> to melee bash."
    USE_COMMAND="GBA_Use"
    HEAL_COMMAND="GBA_QuickHeal"
    HEAL_COMMAND_CONTROLLER="GBA_DPad_Down_Gamepad"
    BASH_COMMAND="GBA_TertiaryFire"
    bIsUnique=true
    bIsConsoleMessage=false
    bBeep=true
    Lifetime=5
}