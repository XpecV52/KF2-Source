/*******************************************************************************
 * KFSeqAct_SetTraderEnabled generated by Eliot.UELib using UE Explorer.
 * Eliot.UELib ? 2009-2022 Eliot van Uytfanghe. All rights reserved.
 * http://eliotvu.com
 *
 * All rights belong to their respective owners.
 *******************************************************************************/
class KFSeqAct_SetTraderEnabled extends SequenceAction
    forcescriptorder(true)
    hidecategories(Object);

/** Whether list of traders should be reset to contain all currently-enabled traders */
var() bool bReinitializeTraderList;

event Activated()
{
    local SeqVar_Object ObjVar;
    local KFTraderTrigger Trader;
    local KFGameInfo KFGI;
    local bool bEnable;

    KFGI = KFGameInfo(Class'WorldInfo'.static.GetWorldInfo().Game);
    if(KFGI == none)
    {
        WarnInternal("KFSeqAct_SetTraderEnabled only supported for KFGameInfo types");
        return;
    }
    bEnable = InputLinks[0].bHasImpulse;
    foreach LinkedVariables(Class'SeqVar_Object', ObjVar, "KF Trader Trigger")
    {
        Trader = KFTraderTrigger(ObjVar.GetObjectValue());
        if(!Trader.bEnabled && bEnable)
        {
            if(KFGI.TraderList.Find(Trader == -1)
            {
                KFGI.TraderList.AddItem(Trader;
            }            
        }
        else
        {
            if(Trader.bEnabled && !bEnable)
            {
                KFGI.TraderList.RemoveItem(Trader;
            }
        }
        Trader.bEnabled = bEnable;        
    }    
    if((KFGI.TraderList.Length == 0) || bReinitializeTraderList)
    {
        KFGI.InitTraderList();
    }
}

defaultproperties
{
    bCallHandler=false
    InputLinks(0)=(LinkDesc="Enable",bHasImpulse=false,QueuedActivations=0,bDisabled=false,bDisabledPIE=false,LinkedOp=none,DrawY=0,bHidden=false,ActivateDelay=0,bMoving=false,bClampedMax=false,bClampedMin=false,OverrideDelta=0)
    InputLinks(1)=(LinkDesc="Disable",bHasImpulse=false,QueuedActivations=0,bDisabled=false,bDisabledPIE=false,LinkedOp=none,DrawY=0,bHidden=false,ActivateDelay=0,bMoving=false,bClampedMax=false,bClampedMin=false,OverrideDelta=0)
    VariableLinks(0)=(ExpectedType=Class'Engine.SeqVar_Object',LinkedVariables=none,LinkDesc="KF Trader Trigger",LinkVar=None,PropertyName=Targets,bWriteable=false,bSequenceNeverReadsOnlyWritesToThisVar=false,bModifiesLinkedObject=false,bHidden=false,MinVars=1,MaxVars=255,DrawX=0,CachedProperty=none,bAllowAnyType=false,bMoving=false,bClampedMax=false,bClampedMin=false,OverrideDelta=0)
    ObjName="Set Trader Enabled"
    ObjCategory="Killing Floor"
}